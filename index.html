<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Singularity - Otomotiv IoT Siber Güvenlik Platformu">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Singularity">
    <title>Singularity - Otomotiv IoT Güvenlik</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="responsive-enhancements.css">
    <link rel="stylesheet" href="touch-target-enhancements.css">
    <link rel="stylesheet" href="mobile-optimization.css">
    <link rel="stylesheet" href="map-styles.css">
    
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div id="offline-banner" class="offline-banner hidden">
        <i class="fas fa-wifi-slash"></i>
        <span>Çevrimdışı Mod - Önbellekten Çalışıyor</span>
    </div>

    <header class="app-header">
        <div class="header-content">
            <h1 class="app-title">
                <i class="fas fa-shield-alt"></i>
                Singularity
            </h1>
            <div class="status-badge online">
                <span class="status-dot"></span>
                <span>Çevrimiçi</span>
            </div>
        </div>
    </header>

    <main class="app-content">
        <div id="device-management" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--success-bg)">
                        <i class="fas fa-car" style="color: var(--success)"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="active-vehicles">0</div>
                        <div class="stat-label">Aktif Araç</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--danger-bg)">
                        <i class="fas fa-exclamation-triangle" style="color: var(--danger)"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="offline-vehicles">0</div>
                        <div class="stat-label">Çevrimdışı</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--warning-bg)">
                        <i class="fas fa-bell" style="color: var(--warning)"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="alerts-count">0</div>
                        <div class="stat-label">Uyarılar</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: var(--info-bg)">
                        <i class="fas fa-download" style="color: var(--info)"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="ota-jobs">0</div>
                        <div class="stat-label">OTA İşleri</div>
                    </div>
                </div>
            </div>

            <div class="section-header">
                <h2>Araç Listesi</h2>
                <button class="icon-btn" id="refresh-vehicles" aria-label="Yenile">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>

            <div class="filters">
                <select id="device-type-filter" class="filter-select">
                    <option value="">Tüm Cihaz Tipleri</option>
                </select>
                <select id="city-filter" class="filter-select">
                    <option value="">Tüm Şehirler</option>
                </select>
                <select id="status-filter" class="filter-select">
                    <option value="">Tüm Durumlar</option>
                    <option value="online">Çevrimiçi</option>
                    <option value="offline">Çevrimdışı</option>
                </select>
                <select id="risk-filter" class="filter-select">
                    <option value="">Tüm Risk Seviyeleri</option>
                    <option value="low">Düşük</option>
                    <option value="medium">Orta</option>
                    <option value="high">Yüksek</option>
                    <option value="critical">Kritik</option>
                </select>
            </div>

            <div id="vehicle-list" class="vehicle-list"></div>
        </div>

        <div id="cybersecurity" class="tab-content">
            <div class="section-header">
                <h2>Canlı Tehdit Akışı</h2>
                <button class="btn btn-primary" id="simulate-threat">
                    <i class="fas fa-bolt"></i>
                    Tehdit Simüle Et
                </button>
            </div>

            <div class="pipeline-container">
                <div class="pipeline-title">Veri İşleme Hattı</div>
                <div class="pipeline">
                    <div class="pipeline-step" data-step="collection">
                        <i class="fas fa-database"></i>
                        <span>Toplama</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="anonymization">
                        <i class="fas fa-user-secret"></i>
                        <span>Anonimleştirme</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="analysis">
                        <i class="fas fa-brain"></i>
                        <span>ML Analiz</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="anomaly">
                        <i class="fas fa-search"></i>
                        <span>Anomali</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="decision">
                        <i class="fas fa-robot"></i>
                        <span>Karar Motoru</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="event">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>Olay</span>
                    </div>
                    <div class="pipeline-arrow">→</div>
                    <div class="pipeline-step" data-step="response">
                        <i class="fas fa-shield-alt"></i>
                        <span>Yanıt</span>
                    </div>
                </div>
            </div>

            <div id="threat-list" class="threat-list"></div>
        </div>

        <div id="predictive-maintenance" class="tab-content">
            <div class="section-header">
                <h2>Kestirimci Bakım</h2>
                <button class="icon-btn" id="refresh-maintenance" aria-label="Yenile">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
            <div id="maintenance-list" class="maintenance-list"></div>
        </div>

        <div id="map-view" class="tab-content">
            <div class="map-controls">
                <button class="btn btn-small" id="toggle-realtime">
                    <i class="fas fa-pause"></i>
                    <span id="realtime-text">Gerçek Zamanı Durdur</span>
                </button>
                <select id="map-layer" class="filter-select">
                    <option value="light">Varsayılan</option>
                    <option value="dark">Koyu</option>
                    <option value="satellite">Alternatif</option>
                </select>
            </div>
            <div id="map" class="map-container"></div>
        </div>

        <footer class="app-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><i class="fas fa-shield-alt"></i> Singularity</h3>
                    <p>Endüstriyel IoT Siber Güvenlik ve Cihaz Yönetimi Platformu</p>
                </div>
                <div class="footer-section">
                    <h4>İletişim</h4>
                    <p>
                        <a href="mailto:info@singularityrd.com" class="footer-link">
                            <i class="fas fa-envelope"></i>
                            info@singularityrd.com
                        </a>
                    </p>
                    <p>
                        <a href="https://singularityrd.com" target="_blank" rel="noopener" class="footer-link">
                            <i class="fas fa-globe"></i>
                            singularityrd.com
                        </a>
                    </p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 Singularity. Tüm hakları saklıdır.</p>
                <p class="footer-notice">
                    <i class="fas fa-info-circle"></i>
                    Bu bir simülasyondur, gerçek veriler içermez
                </p>
            </div>
        </footer>
    </main>

    <nav class="bottom-nav">
        <button class="nav-item active" data-tab="device-management" aria-label="Cihaz Yönetimi">
            <i class="fas fa-car"></i>
            <span>Cihaz</span>
        </button>
        <button class="nav-item" data-tab="cybersecurity" aria-label="Siber Güvenlik">
            <i class="fas fa-shield-alt"></i>
            <span>Siber</span>
        </button>
        <button class="nav-item" data-tab="predictive-maintenance" aria-label="Kestirimci Bakım">
            <i class="fas fa-wrench"></i>
            <span>Bakım</span>
        </button>
        <button class="nav-item" data-tab="map-view" aria-label="Harita">
            <i class="fas fa-map"></i>
            <span>Harita</span>
        </button>
    </nav>

    <div id="bottom-sheet" class="bottom-sheet">
        <div class="bottom-sheet-handle"></div>
        <div id="bottom-sheet-content" class="bottom-sheet-content"></div>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3><i class="fas fa-shield-alt"></i> Singularity</h3>
                <p>Endüstriyel IoT Siber Güvenlik ve Cihaz Yönetimi Platformu</p>
            </div>
            <div class="footer-section">
                <h4>İletişim</h4>
                <p>
                    <a href="mailto:info@singularityrd.com" class="footer-link">
                        <i class="fas fa-envelope"></i>
                        info@singularityrd.com
                    </a>
                </p>
                <p>
                    <a href="https://singularityrd.com" target="_blank" rel="noopener" class="footer-link">
                        <i class="fas fa-globe"></i>
                        singularityrd.com
                    </a>
                </p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© 2025 Singularity. Tüm hakları saklıdır.</p>
            <p class="footer-notice">
                <i class="fas fa-info-circle"></i>
                Bu bir simülasyondur, gerçek veriler içermez
            </p>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" defer></script>
    <script src="script.js" defer></script>
    <script src="map-functions.js" defer></script>
    <script src="dashboard-fixes.js" defer></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('Service Worker kayıtlı'))
                    .catch(err => console.log('Service Worker kayıt hatası:', err));
            });
        }

        window.addEventListener('online', () => {
            document.getElementById('offline-banner').classList.add('hidden');
        });
        window.addEventListener('offline', () => {
            document.getElementById('offline-banner').classList.remove('hidden');
        });
    </script>
</body>
</html>
